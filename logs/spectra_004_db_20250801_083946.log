2025-08-01 08:39:46,763 [INFO] tgarchive.config_models: Loaded config from <MagicMock id='140127066758736'>
2025-08-01 08:39:46,764 [INFO] tgarchive.forwarding.AttachmentForwarder: File grouping strategy: none
2025-08-01 08:39:46,765 [INFO] tgarchive.forwarding.AttachmentForwarder: Deduplication is ENABLED.
2025-08-01 08:39:46,766 [INFO] tgarchive.forwarding.AttachmentForwarder: Loaded 0 existing file content hashes (SHA256) into memory.
2025-08-01 08:39:46,775 [INFO] tgarchive.forwarding.AttachmentForwarder:   Comparing fhash: 12:hu0yJv0I0yJv0I0yJv0I0yJv0I0yJv0I0yJv0I0yJv0I0yJv0I0yJv0SflUn:daSaSaSaSaSaSaSaSaDtUn with 12:hu0yJv0I0yJv0I0yJv0I0yJv0I0yJv0I0yJv0I0yJv0I0yJv0I0yJv0I0yJv0b:daSaSaSaSaSaSaSaSaSaw, similarity: 91
2025-08-01 08:39:46,775 [INFO] tgarchive.forwarding.AttachmentForwarder: Near-duplicate file found for Msg ID 4 (fuzzy hash similarity: 91% >= 90%, matches file_id: 3).
2025-08-01 08:39:46,777 [INFO] tgarchive.config_models: Loaded config from <MagicMock id='140127066201152'>
2025-08-01 08:39:46,777 [INFO] tgarchive.forwarding.AttachmentForwarder: File grouping strategy: none
2025-08-01 08:39:46,777 [INFO] tgarchive.forwarding.AttachmentForwarder: Deduplication is ENABLED.
2025-08-01 08:39:46,778 [INFO] tgarchive.forwarding.AttachmentForwarder: Loaded 0 existing file content hashes (SHA256) into memory.
2025-08-01 08:39:47,046 [INFO] tgarchive.forwarding.AttachmentForwarder:   Comparing phash: c13e6ec4917b6a94 with d13f2ec0917b6a94, distance: 4
2025-08-01 08:39:47,047 [INFO] tgarchive.forwarding.AttachmentForwarder: Near-duplicate image found for Msg ID 2 (pHash distance: 4 <= 5, matches file_id: 1).
2025-08-01 08:39:47,080 [INFO] spectra_004_db: DB ready at test.db
2025-08-01 08:39:47,113 [INFO] spectra_004_db: DB ready at test.db
2025-08-01 08:39:47,144 [INFO] spectra_004_db: DB ready at test.db
2025-08-01 08:39:47,177 [INFO] spectra_004_db: DB ready at test.db
2025-08-01 08:39:47,355 [INFO] spectra_004_db: DB ready at test.db
2025-08-01 08:39:47,392 [INFO] spectra_004_db: DB ready at test.db
2025-08-01 08:39:47,425 [INFO] spectra_004_db: DB ready at test.db
2025-08-01 08:39:47,429 [ERROR] tgarchive.file_sorter: Error updating category stats for test.pdf: [Errno 2] No such file or directory: 'test.pdf'
2025-08-01 08:39:47,429 [ERROR] tgarchive.file_sorter: Error updating category stats for test.jpg: [Errno 2] No such file or directory: 'test.jpg'
2025-08-01 08:39:47,430 [ERROR] tgarchive.file_sorter: Error getting MIME type for test.unknown: test error
2025-08-01 08:39:47,430 [ERROR] tgarchive.file_sorter: Error updating category stats for test.unknown: [Errno 2] No such file or directory: 'test.unknown'
2025-08-01 08:39:47,464 [INFO] spectra_004_db: DB ready at test.db
2025-08-01 08:39:47,482 [INFO] tgarchive.config_models: Configuration saved to <MagicMock spec='Path' id='140126584609328'>
2025-08-01 08:39:47,487 [INFO] tgarchive.forwarding.AttachmentForwarder: File grouping strategy: none
2025-08-01 08:39:47,487 [INFO] tgarchive.forwarding.AttachmentForwarder: Deduplication is ENABLED.
2025-08-01 08:39:47,488 [INFO] tgarchive.forwarding.AttachmentForwarder: Loaded 0 existing file content hashes (SHA256) into memory.
2025-08-01 08:39:47,489 [INFO] tgarchive.forwarding.AttachmentForwarder: File grouping strategy: filename
2025-08-01 08:39:47,489 [INFO] tgarchive.forwarding.AttachmentForwarder: Deduplication is ENABLED.
2025-08-01 08:39:47,490 [INFO] tgarchive.forwarding.AttachmentForwarder: Loaded 0 existing file content hashes (SHA256) into memory.
2025-08-01 08:39:47,495 [INFO] tgarchive.config_models: Configuration saved to <MagicMock spec='Path' id='140126555114960'>
2025-08-01 08:39:47,496 [INFO] tgarchive.forwarding.AttachmentForwarder: File grouping strategy: none
2025-08-01 08:39:47,496 [INFO] tgarchive.forwarding.AttachmentForwarder: Deduplication is ENABLED.
2025-08-01 08:39:47,498 [INFO] tgarchive.forwarding.AttachmentForwarder: Loaded 0 existing file content hashes (SHA256) into memory.
2025-08-01 08:39:47,498 [INFO] tgarchive.forwarding.AttachmentForwarder: File grouping strategy: time
2025-08-01 08:39:47,498 [INFO] tgarchive.forwarding.AttachmentForwarder: Grouping time window: 60 seconds
2025-08-01 08:39:47,498 [INFO] tgarchive.forwarding.AttachmentForwarder: Deduplication is ENABLED.
2025-08-01 08:39:47,499 [INFO] tgarchive.forwarding.AttachmentForwarder: Loaded 0 existing file content hashes (SHA256) into memory.
2025-08-01 08:39:47,546 [INFO] tgarchive.config_models: Configuration saved to <MagicMock spec='Path' id='140126555390032'>
2025-08-01 08:39:47,547 [INFO] tgarchive.forwarding.AttachmentForwarder: File grouping strategy: none
2025-08-01 08:39:47,547 [INFO] tgarchive.forwarding.AttachmentForwarder: Deduplication is ENABLED.
2025-08-01 08:39:47,548 [INFO] tgarchive.forwarding.AttachmentForwarder: Loaded 0 existing file content hashes (SHA256) into memory.
2025-08-01 08:39:47,551 [INFO] tgarchive.config_models: Loaded config from spectra_config.json
2025-08-01 08:39:47,583 [INFO] spectra_004_db: DB ready at test.db
2025-08-01 08:39:47,584 [INFO] tgarchive.forwarding.SortingForwarder: File grouping strategy: none
2025-08-01 08:39:47,584 [INFO] tgarchive.forwarding.SortingForwarder: Deduplication is ENABLED.
2025-08-01 08:39:47,584 [INFO] tgarchive.forwarding.SortingForwarder: Loaded 0 existing file content hashes (SHA256) into memory.
2025-08-01 08:39:47,589 [ERROR] tgarchive.file_sorter: Error getting MIME type for /tmp/tmp4zhp_2pd/MagicMock/doc1.pdf.name/140126555478720: [Errno 2] No such file or directory: '/tmp/tmp4zhp_2pd/MagicMock/doc1.pdf.name/140126555478720'
2025-08-01 08:39:47,589 [ERROR] tgarchive.file_sorter: Error updating category stats for /tmp/tmp4zhp_2pd/MagicMock/doc1.pdf.name/140126555478720: [Errno 2] No such file or directory: '/tmp/tmp4zhp_2pd/MagicMock/doc1.pdf.name/140126555478720'
2025-08-01 08:39:47,592 [ERROR] tgarchive.file_sorter: Error getting MIME type for /tmp/tmp4zhp_2pd/MagicMock/archive1.zip.name/140126555391712: [Errno 2] No such file or directory: '/tmp/tmp4zhp_2pd/MagicMock/archive1.zip.name/140126555391712'
2025-08-01 08:39:47,593 [ERROR] tgarchive.file_sorter: Error updating category stats for /tmp/tmp4zhp_2pd/MagicMock/archive1.zip.name/140126555391712: [Errno 2] No such file or directory: '/tmp/tmp4zhp_2pd/MagicMock/archive1.zip.name/140126555391712'
2025-08-01 08:39:47,595 [ERROR] tgarchive.file_sorter: Error getting MIME type for /tmp/tmp4zhp_2pd/MagicMock/readme.txt.name/140127067160848: [Errno 2] No such file or directory: '/tmp/tmp4zhp_2pd/MagicMock/readme.txt.name/140127067160848'
2025-08-01 08:39:47,595 [ERROR] tgarchive.file_sorter: Error updating category stats for /tmp/tmp4zhp_2pd/MagicMock/readme.txt.name/140127067160848: [Errno 2] No such file or directory: '/tmp/tmp4zhp_2pd/MagicMock/readme.txt.name/140127067160848'
2025-08-01 08:39:47,600 [INFO] tgarchive.config_models: Loaded config from spectra_config.json
2025-08-01 08:39:47,630 [INFO] spectra_004_db: DB ready at test.db
2025-08-01 08:39:47,630 [INFO] tgarchive.forwarding.AttachmentForwarder: File grouping strategy: none
2025-08-01 08:39:47,630 [INFO] tgarchive.forwarding.AttachmentForwarder: Deduplication is ENABLED.
2025-08-01 08:39:47,630 [INFO] tgarchive.forwarding.AttachmentForwarder: Loaded 0 existing file content hashes (SHA256) into memory.
2025-08-01 08:39:47,633 [INFO] tgarchive.config_models: Loaded config from spectra_config.json
2025-08-01 08:39:47,673 [INFO] spectra_004_db: DB ready at test.db
2025-08-01 08:39:47,674 [INFO] tgarchive.forwarding.AttachmentForwarder: File grouping strategy: none
2025-08-01 08:39:47,674 [INFO] tgarchive.forwarding.AttachmentForwarder: Deduplication is ENABLED.
2025-08-01 08:39:47,674 [INFO] tgarchive.forwarding.AttachmentForwarder: Loaded 0 existing file content hashes (SHA256) into memory.
2025-08-01 08:39:47,675 [INFO] tgarchive.config_models: Loaded config from <MagicMock id='140126555393536'>
2025-08-01 08:39:47,676 [INFO] tgarchive.forwarding.AttachmentForwarder: File grouping strategy: none
2025-08-01 08:39:47,676 [INFO] tgarchive.forwarding.AttachmentForwarder: Deduplication is ENABLED.
2025-08-01 08:39:47,677 [INFO] tgarchive.forwarding.AttachmentForwarder: Loaded 0 existing file content hashes (SHA256) into memory.
2025-08-01 08:39:47,680 [INFO] tgarchive.forwarding.AttachmentForwarder: Recorded forwarded file (Msg ID 1, SHA256: 54eb06f8ca...) to database.
2025-08-01 08:39:47,681 [INFO] tgarchive.forwarding.AttachmentForwarder: Duplicate file found (Msg ID 1, SHA256: 54eb06f8ca...) via in-memory cache.
2025-08-01 08:39:47,682 [INFO] tgarchive.forwarding.AttachmentForwarder: Duplicate file found (Msg ID 1, SHA256: 54eb06f8ca...) via database.
2025-08-01 08:39:47,686 [INFO] tgarchive.forwarding.SortingForwarder: File grouping strategy: none
2025-08-01 08:39:47,686 [INFO] tgarchive.forwarding.SortingForwarder: Deduplication is ENABLED.
2025-08-01 08:39:47,687 [ERROR] tgarchive.forwarding.SortingForwarder: Error loading existing file hashes: 'Mock' object is not iterable
Traceback (most recent call last):
  File "/app/tgarchive/forwarding.py", line 142, in _load_existing_hashes
    for row in cursor:
               ^^^^^^
TypeError: 'Mock' object is not iterable
2025-08-01 08:39:47,690 [INFO] tgarchive.forwarding.SortingForwarder: File grouping strategy: none
2025-08-01 08:39:47,690 [INFO] tgarchive.forwarding.SortingForwarder: Deduplication is ENABLED.
2025-08-01 08:39:47,691 [ERROR] tgarchive.forwarding.SortingForwarder: Error loading existing file hashes: 'Mock' object is not iterable
Traceback (most recent call last):
  File "/app/tgarchive/forwarding.py", line 142, in _load_existing_hashes
    for row in cursor:
               ^^^^^^
TypeError: 'Mock' object is not iterable
2025-08-01 08:39:47,732 [INFO] spectra_004_db: DB ready at test.db
